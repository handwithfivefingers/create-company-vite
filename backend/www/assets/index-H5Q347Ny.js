import{r as s,A as R,_ as S,i as T,j as e,M as z,B as y,e as X,E as q,f as J,g as Z,c as ee,F,I as te,h as ne,k as ae,L as ie,T as g,n as se,l as le,m as N,o as oe}from"./index-XD4JDM6b.js";import{C as re}from"./index-akrSOs4w.js";import ce from"./index-n8TiZ9Qh.js";import{T as O}from"./Timeline-L2atCUlM.js";import{F as H}from"./FormOutlined-lKW3anG1.js";import{T as h}from"./Table-UH30mYPz.js";import{P as de}from"./index-K-fwyXvc.js";import{D as he}from"./DeleteOutlined-bNd3EvOf.js";import"./index--frXZXQx.js";import"./index-ehUL30Ed.js";import"./index-gcWtjv3K.js";import"./dropdown-D6H3nMuz.js";import"./MoreOutlined-kX5gnkaD.js";import"./index-Rc3KqxQe.js";var me={icon:function(c,o){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:c}},{tag:"path",attrs:{d:"M512 140c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm193.4 225.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.3 0 19.9 5 25.9 13.3l71.2 98.8 157.2-218c6-8.4 15.7-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.4 12.7z",fill:o}},{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z",fill:c}}]}},name:"check-circle",theme:"twotone"};const pe=me;var $=function(c,o){return s.createElement(R,S(S({},c),{},{ref:o,icon:pe}))};$.displayName="CheckCircleTwoTone";const ue=s.forwardRef($);var xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0068.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"}}]},name:"mail",theme:"outlined"};const _e=xe;var A=function(c,o){return s.createElement(R,S(S({},c),{},{ref:o,icon:_e}))};A.displayName="MailOutlined";const ge=s.forwardRef(A),b={getOrder:"/admin/order",deleteOrder:"/admin/order",previewFileOrder:"/admin/order/preview"},I={getOrder:i=>T.get(b.getOrder,i),getOrderBySlug:i=>T.get(`${b.getOrder}/${i.slug}`),deleteOrder:i=>T.delete(b.deleteOrder+"/"+i),previewFileOrder:i=>T.get(b.previewFileOrder+"/"+i)},fe="_action_120so_1",ye={action:fe},je=s.forwardRef((i,c)=>{var _,m,v,p;const[o,j]=s.useState(!1),[d,x]=s.useState({});s.useImperativeHandle(c,()=>({openModal:C,closeModal:r,setData:x}),[i]);const C=()=>j(!0),r=()=>j(!1);return e.jsxs(z,{open:o,onCancel:r,onOk:r,width:400,children:[e.jsx("div",{className:ye.heading,children:e.jsx("h2",{children:"Trạng thái"})}),e.jsxs(O,{pending:"Recording...",children:[e.jsxs(O.Item,{children:["Khởi tạo đơn hàng vào ngày ",(m=(_=d==null?void 0:d.createdAt)==null?void 0:_.split("T"))==null?void 0:m[0]]}),e.jsxs(O.Item,{children:["Thanh toán đơn hàng vào ngày ",(p=(v=d==null?void 0:d.createdAt)==null?void 0:v.split("T"))==null?void 0:p[0]]}),e.jsx(O.Item,{children:"Technical testing 2015-09-01"})]})]})}),ve="_action_120so_1",D={action:ve},we=s.forwardRef((i,c)=>{const{onUpdateOrder:o,onUpdateStatus:j,onPreviewPDF:d,onConvertFileManual:x,...C}=i,[r,_]=s.useState(!1),[m,v]=s.useState({});s.useImperativeHandle(c,()=>({openModal:p,closeModal:M,setData:v}),[i]);const p=()=>_(!0),M=()=>_(!1);return e.jsxs(z,{open:r,onCancel:M,onOk:M,...C,children:[e.jsx("div",{className:D.heading,children:e.jsx("h2",{children:"Tùy chỉnh"})}),e.jsxs("ul",{className:D.action,children:[e.jsx("li",{children:e.jsx(y,{type:"text",onClick:()=>o(m),icon:e.jsx(H,{}),children:"Chỉnh sửa nội dung"})}),e.jsx("li",{children:e.jsx(y,{type:"text",onClick:()=>j(m),icon:e.jsx(ge,{}),children:"Trạng thái và email"})}),e.jsx("li",{children:e.jsx(y,{type:"text",onClick:()=>x(m),icon:e.jsx(X,{fontSize:16}),style:{display:"flex",alignItems:"center",gap:8},children:"Convert file thủ công"})}),e.jsx("li",{children:e.jsx(y,{type:"text",onClick:()=>d(m),icon:e.jsx(q,{}),children:"Xem trước nội dung"})})]})]})}),Ce="_inline_360iy_78",Me="_box__shadow_360iy_139",Te="_searchForm_360iy_150",Oe="_header_360iy_166",be="_inpSearch_360iy_173",Se="_tableWrapper_360iy_177",ke="_filter_360iy_193",Fe="_pagination_360iy_222",Ne="_contentWrapper_360iy_228",f={"ant-table-scroll-horizontal":"_ant-table-scroll-horizontal_360iy_1","ant-table-container":"_ant-table-container_360iy_1","ant-table-content":"_ant-table-content_360iy_1","ant-layout-sider-trigger":"_ant-layout-sider-trigger_360iy_24","ant-layout-footer":"_ant-layout-footer_360iy_29","ant-form-item-control-input-content":"_ant-form-item-control-input-content_360iy_33","ant-picker":"_ant-picker_360iy_48","ant-select-selector":"_ant-select-selector_360iy_49","ant-form-item":"_ant-form-item_360iy_33","ant-row":"_ant-row_360iy_62","site-layout-background":"_site-layout-background_360iy_66","spin-suspense":"_spin-suspense_360iy_70",inline:Ce,"cc-scroll":"_cc-scroll_360iy_90","cc-card":"_cc-card_360iy_114",box__shadow:Me,"ant-tabs-content-holder":"_ant-tabs-content-holder_360iy_143","ant-tabs-content":"_ant-tabs-content_360iy_143",searchForm:Te,header:Oe,inpSearch:be,tableWrapper:Se,filter:ke,pagination:Fe,contentWrapper:Ne},Ve=()=>{const[i,c]=s.useState([]),[o,j]=s.useState(1),d=s.useRef(),x=s.useRef(),C=J(),{data:r,isLoading:_,status:m,refetch:v}=Z({cacheName:["adminOrder"],fn:()=>I.getOrder()}),p={current:o,total:r==null?void 0:r.count,pageSize:10,onChange:n=>{j(n)}};s.useEffect(()=>{var n;if(m==="success"&&r){const t=(n=r==null?void 0:r.data)==null?void 0:n.slice((o-1)*p.pageSize,(o-1)*p.pageSize+p.pageSize);c(t)}},[o,r]);const M=async n=>{try{let t=await I.deleteOrder(n);t.data.status===200?N.success(t.data.message):N.error(t.data.message)}catch{}finally{v()}},P=n=>{d.current.setData(n),d.current.openModal()},L=n=>{let t=null;return t=e.jsxs(le,{children:[e.jsx(y,{type:"primary",onClick:()=>P(n),disabled:!(n!=null&&n.data),icon:e.jsx(H,{})}),e.jsx(de,{placement:"topRight",title:"Bạn có muốn xoá ?",onConfirm:()=>M(n._id),okText:"Yes",cancelText:"No",children:e.jsx(y,{icon:e.jsx(he,{})})})]}),t},W=n=>{let{data:t}=n,a=null;for(let l in t)l==="pending"?a="tam-ngung":l==="change_info"?a="thay-doi-thong-tin":l==="dissolution"?a="giai-the":l==="create_company"&&(a="thanh-lap-doanh-nghiep");C(`/user/san-pham/${a}`,{state:{...n}})},B=n=>{x.current.setData(n),x.current.openModal()},E=async n=>{var t,a,l,u;try{const w=await I.previewFileOrder(n._id);(l=(a=(t=w.data)==null?void 0:t.data)==null?void 0:a.data)!=null&&l.length?z.info({title:"File Info",content:e.jsx("ul",{children:(u=w.data.data.data)==null?void 0:u.map((k,Q)=>e.jsx("li",{children:e.jsx("a",{href:`/${k.url}`,target:"blank",children:k.name})},k.name+Q))}),width:500}):N.info("Chưa có files")}catch{}},U=n=>{let t=oe(n.createdAt).format("DD/MM/YYYY HH:mm");return e.jsx("span",{style:{display:"block",width:120},children:t})},Y=(n,t)=>{var a,l,u,w;if((a=t==null?void 0:t.data)!=null&&a.create_company)return e.jsx(g,{color:"#108ee9",children:"Thành lập doanh nghiệp"},[Math.random(),Math.random().toFixed(Math.random()*10)]);if((l=t==null?void 0:t.data)!=null&&l.change_info)return e.jsx(g,{color:"#108ee9",children:"Thay đổi thông tin"},[Math.random(),Math.random().toFixed(Math.random()*10)]);if((u=t==null?void 0:t.data)!=null&&u.pending)return e.jsx(g,{color:"#108ee9",children:"Tạm hoãn"},[Math.random(),Math.random().toFixed(Math.random()*10)]);if((w=t==null?void 0:t.data)!=null&&w.dissolution)return e.jsx(g,{color:"#108ee9",children:"Giải thể"},[Math.random(),Math.random().toFixed(Math.random()*10)])},V=(n,t)=>{var l;let a=[];return t!=null&&t.category&&(a=e.jsx(g,{color:"#108ee9",children:(l=t==null?void 0:t.category)==null?void 0:l.name})),a},G=n=>{},K=n=>{};return e.jsxs(e.Fragment,{children:[e.jsx(ce,{title:"Quản lý đơn hàng"}),e.jsxs("div",{className:f.contentWrapper,children:[e.jsxs("div",{className:f.tableWrapper,children:[e.jsx("div",{className:ee(f.filter,""),children:e.jsxs(F,{onFinish:K,layout:"vertical",children:[e.jsx(F.Item,{name:"_id",label:"Mã đơn",children:e.jsx(te,{})}),e.jsx(F.Item,{name:"product",label:"Sản phẩm",children:e.jsx(ne,{options:[{label:"Thành lập doanh nghiệp",value:"create_company"},{label:"Thay đổi thông tin",value:"change_info"},{label:"Tạm hoãn",value:"pending"},{label:"Giải thể",value:"dissolution"}]})}),e.jsx(y,{type:"primary",htmlType:"submit",children:"Tìm kiếm"})]})}),e.jsxs(h,{size:"small",dataSource:i,loading:{spinning:_,tip:"Loading...",delay:100},bordered:!0,className:"table rounded",pagination:!1,rowKey:n=>n._id||ae(9),scroll:{x:1500},children:[e.jsx(h.Column,{title:"Mã đơn",width:210,render:(n,t)=>t==null?void 0:t._id}),e.jsx(h.Column,{className:f.inline,title:"Người đăng kí",width:"175px",render:(n,t)=>{var a;return e.jsx("span",{children:(a=t==null?void 0:t.orderOwner)==null?void 0:a.email})}}),e.jsx(h.Column,{title:"Sản phẩm",render:Y,width:175}),e.jsx(h.Column,{title:"Dịch vụ",width:275,render:V}),e.jsx(h.Column,{width:"150px",align:"center",title:"Mã hóa đơn",render:(n,t)=>{var l,u;return((l=t==null?void 0:t.transactionId)==null?void 0:l.paymentType)&&((u=t==null?void 0:t.transactionId)==null?void 0:u.paymentCode)||"-"}}),e.jsx(h.Column,{className:f.inline,dataIndex:"fileReady",title:"Tệp tài liệu",align:"center",width:"100px",render:(n,t)=>t!=null&&t.fileReady?e.jsx(ue,{twoToneColor:"#52c41a"}):e.jsx(ie,{spin:!0})}),e.jsx(h.Column,{align:"center",title:"Thanh toán",width:"120px",dataIndex:"",render:(n,t)=>{var a;return(a=t==null?void 0:t.transactionId)!=null&&a.isPayment?e.jsx(g,{color:"green",children:"Đã thanh toán"}):e.jsx(g,{color:"volcano",children:"Chưa thanh toán"})}}),e.jsx(h.Column,{title:"Ngày tạo",width:150,render:(n,t)=>U(t)}),e.jsx(h.Column,{className:f.inline,title:"Giá tiền",width:"135px",render:(n,t)=>e.jsxs(e.Fragment,{children:[se(t==null?void 0:t.price)," VND"]})}),e.jsx(h.Column,{title:"",width:85,render:(n,t)=>L(t)})]})]}),e.jsx("div",{className:f.pagination,children:e.jsx(re,{...p})}),e.jsx(we,{ref:d,onUpdateOrder:W,onUpdateStatus:B,onPreviewPDF:E,onConvertFileManual:G,width:300}),e.jsx(je,{ref:x})]})]})};export{Ve as default};
