import{bW as D,r as f,ak as F,F as u,u as V,g as P,j as e,c as W,R as $,C as I,h as x,ag as z,I as G,T as K,bX as T}from"./index-XD4JDM6b.js";function X(l){return D({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M3 2v4.586l7 7L14.586 9l-7-7H3zM2 2a1 1 0 0 1 1-1h4.586a1 1 0 0 1 .707.293l7 7a1 1 0 0 1 0 1.414l-4.586 4.586a1 1 0 0 1-1.414 0l-7-7A1 1 0 0 1 2 6.586V2z"}},{tag:"path",attr:{d:"M5.5 5a.5.5 0 1 1 0-1 .5.5 0 0 1 0 1zm0 1a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zM1 7.086a1 1 0 0 0 .293.707L8.75 15.25l-.043.043a1 1 0 0 1-1.414 0l-7-7A1 1 0 0 1 0 7.586V3a1 1 0 0 1 1-1v5.086z"}}]})(l)}const A="_hide_nq76n_1",H="_visible_nq76n_10",Q="_list_nq76n_24",k={hide:A,visible:H,list:Q},U=f.memo(({BASE_FORM:l,className:m})=>{var v;const{currentStep:p}=F(),g=u.useFormInstance(),a=u.useWatch([...l,"company_career_type"],g),h=u.useWatch([...l,"company_career_group"],g),[y,q]=f.useState(!1),d=V({queryKey:["listCategory",h],queryFn:async()=>(await T.getListCareerByCategory({category:h})).data.data,enabled:!!h||!!a}),{data:_,refetch:L}=P({cacheName:["careerCate"],fn:()=>T.getCareerCategory()});f.useEffect(()=>{window.form=g},[]);const j=f.useMemo(()=>{var r,c;return y&&a===2&&(h!=null&&h.length)&&((r=d==null?void 0:d.data)!=null&&r.length)?(c=d==null?void 0:d.data)==null?void 0:c.map(i=>({...i,value:i._id,code:i.code,name:i.name})):[]},[h,a,d,y]),{data:n}=V(["career"],async()=>(await T.fetchCareer()).data.data),s=(r,c)=>{let i;Array.isArray(c)?i=c.map(({code:C,name:b,value:w})=>({code:C,name:b,value:w})):i={code:c.code,name:c.name,value:c.value},g.setFields([{name:r,value:i}])},t=(r,c)=>{var b,w;const{children:i}=c,C=(r==null?void 0:r.toLowerCase())||"";return i?Array.isArray(i)?((b=i.join("").toLowerCase())==null?void 0:b.indexOf(C))>=0:((w=i.toLowerCase())==null?void 0:w.indexOf(C))>=0:!1},o=()=>{L()};return e.jsx(u.Item,{label:e.jsx("h2",{children:"Ngành nghề đăng kí kinh doanh"}),className:W([k.hide,m,{[k.visible]:p===6}]),children:e.jsxs($,{gutter:[16,12],children:[e.jsx(I,{span:24,children:e.jsx(u.Item,{label:"Vui lòng chọn",required:!0,name:[...l,"company_career_type"],rules:[{required:!0,message:"Vui lòng chọn ngành nghề đăng kí"}],children:e.jsxs(x,{placeholder:"Bấm vào đây",onChange:o,children:[e.jsx(x.Option,{value:1,children:"Tự chọn ngành nghề"}),e.jsx(x.Option,{value:2,children:"Chọn theo lĩnh vực đề xuất"})]})})}),a===2&&e.jsx(I,{span:24,children:e.jsx(u.Item,{label:"Chọn nhóm ngành nghề",required:!0,rules:[{required:!0,message:"Vui lòng chọn nhóm ngành nghề"}],name:[...l,"company_career_group"],children:e.jsx(x,{showSearch:!0,allowClear:!0,optionFilterProp:"children",filterOption:t,placeholder:"Vui lòng bấm vào đây để chọn nhóm ngành liên quan",mode:"tags",tagRender:N,onChange:()=>!y&&q(!0),showArrow:!0,children:_==null?void 0:_.map(({name:r,_id:c})=>e.jsx(x.Option,{value:c,children:r},c))})})}),!!a&&e.jsxs(e.Fragment,{children:[e.jsx(I,{span:24,children:e.jsx(S,{data:n,BASE_FORM:l,autofillOptions:j})}),e.jsx(I,{span:24,children:e.jsx(u.Item,{name:[...l,"company_main_career"],label:e.jsxs("div",{children:["Chọn ngành nghề kinh doanh chính ",e.jsx("br",{}),e.jsx(z.Text,{italic:!0,children:"(Giới hạn tối đa 1 ngành nghề chính)"})]}),children:e.jsx(x,{showSearch:!0,allowClear:!0,optionFilterProp:"children",filterOption:t,onChange:(r,c)=>s([...l,"company_main_career"],c),required:!0,rules:[{required:!0,message:"Vui lòng chọn nhóm ngành nghề"}],children:(v=d==null?void 0:d.data)==null?void 0:v.map(r=>e.jsxs(x.Option,{value:r._id,code:r.code,name:r.name,children:[r.code," - ",r.name]},r._id))})})})]})]})})}),S=f.memo(({BASE_FORM:l,data:m,autofillOptions:p})=>{const g=u.useFormInstance(),a=u.useWatch([...l,"company_opt_career_mirror"],g),h=f.useMemo(()=>{const n=[];if(m!=null&&m.length)for(let s of m)a!=null&&a.some(o=>o._id===s._id||o.value===s._id)||n.push(s);return n},[a]),y=f.useMemo(()=>{const n=a!=null&&a.length?a:[];if(p!=null&&p.length)for(let s of p)a!=null&&a.some(o=>o._id===s._id||o.value===s._id)||n.push(s);return n},[p,a]),q=(n,s)=>{var v,r;const{children:t}=s,o=(n==null?void 0:n.toLowerCase())||"";return t?Array.isArray(t)?((v=t.join("").toLowerCase())==null?void 0:v.indexOf(o))>=0:((r=t.toLowerCase())==null?void 0:r.indexOf(o))>=0:!1},d=n=>{const t=[...a].filter(o=>o.value!==n.value);j(t)},_=()=>{let n=null;return n=y==null?void 0:y.map(s=>N({label:`${s.code} ${s.name}`,closable:!0,onClose:()=>d(s),key:`tag_opt_career${s.code}`})),n},L=(n,s)=>{const t=a!=null&&a.length?[...a]:[];let o=[];(t==null?void 0:t.some(r=>r.value===s.value))?o=(t==null?void 0:t.filter(r=>r.value!==s.value))||[]:o=[...t,s],j(o)},j=n=>{g.setFields([{name:[...l,"company_opt_career"],value:n}]),g.setFields([{name:[...l,"company_opt_career_mirror"],value:n}])};return e.jsxs(u.Item,{name:[...l,"company_opt_career_mirror"],label:e.jsxs("div",{children:["Chọn ngành nghề kinh doanh ",e.jsx("br",{}),e.jsx(z.Text,{type:"danger",italic:!0,children:"Nếu muốn bỏ bớt ngành vui lòng bấm dấu X"})]}),children:[e.jsx(x,{showSearch:!0,allowClear:!0,style:{width:"100%"},onChange:L,optionFilterProp:"children",filterOption:q,tagRender:N,showArrow:!0,value:"Bấm vào đây để thêm ngành nghề mới",children:h==null?void 0:h.map(n=>e.jsxs(x.Option,{value:n._id,code:n.code,name:n.name,children:[n.code,"-",n.name]},"company_opt_career_mirror"+n._id))}),e.jsxs("div",{className:k.list,children:[e.jsx(u.Item,{name:[...l,"company_opt_career"],noStyle:!0,children:e.jsx(G,{type:"hidden"})}),_()]})]})}),N=l=>{const{label:m,closable:p,onClose:g}=l,a=h=>{h.preventDefault(),h.stopPropagation()};return e.jsx(K,{color:"purple",onMouseDown:a,closable:p,onClose:g,style:{marginRight:3,display:"flex",gap:4,overflow:"hidden",alignItems:"center",justifyContent:"flex-start",padding:"2px 4px",margin:1},icon:e.jsx(X,{fontSize:16,style:{flex:1,width:16,height:16}}),children:m},`${m}`)};export{U as default};
