import{i as c,ao as I,f as Y,ay as b,F as t,r as g,g as A,j as s,R as F,C as x,a as p,o as a,I as h,az as N,B as k,m as j}from"./index-XD4JDM6b.js";import{G as v}from"./index-Dike2iIH.js";import{T as l}from"./Timeline-L2atCUlM.js";const d={profile:"/user/profile",changePassword:"/user/profile/password"},f={getProfile:()=>c.get(d.profile),changeProfile:({_id:n,...r})=>c.post(d.profile+"/"+n,r),changePassword:n=>c.post(d.changePassword,n)},{useBreakpoint:S}=v,R=()=>{const{animateClass:n}=I();Y();const r=b(),[i]=t.useForm(),m=S(),[y,u]=g.useState(!1),{data:e,refetch:P,status:T,isLoading:_}=A({cacheName:["userProfile"],fn:()=>f.getProfile(),enabled:r.status&&!0||!1});g.useEffect(()=>{e!=null&&e._id&&i.setFieldsValue({email:e.email,name:e.name,phone:e.phone,_id:e._id})},[_]);const w=async C=>{try{u(!0);const o={...C,_id:i.getFieldValue("_id")};await f.changeProfile(o),j.success("Cập nhật thành công"),P()}catch(o){j.error(o.toString())}finally{u(!1)}};return s.jsxs(F,{className:n??n,gutter:[8,8],children:[s.jsx(x,{lg:8,sm:24,xs:24,md:12,order:m.md?0:1,children:s.jsx(p,{title:"Dòng thời gian",className:"box__shadow ",style:{height:"100%"},children:s.jsxs(l,{children:[(e==null?void 0:e.createdAt)&&s.jsxs(l.Item,{children:["Khởi tạo tài khoản vào lúc ",a(e==null?void 0:e.createdAt).format("DD/MM/YYYY")]}),a(e==null?void 0:e.updatedAt).unix()-a(e==null?void 0:e.createdAt).unix()>0&&s.jsxs(l.Item,{children:["Cập nhật tài khoản vào lúc ",a(e==null?void 0:e.updatedAt).format("DD/MM/YYYY")]})]})})}),s.jsx(x,{lg:16,sm:24,xs:24,md:12,className:m.md?"p-l-8":"",children:s.jsx(p,{title:"Thông tin cá nhân",className:"box__shadow ",style:{height:"100%"},children:s.jsxs(t,{onFinish:w,form:i,layout:"vertical",children:[s.jsx(t.Item,{label:"Tên sở hữu",name:"name",children:s.jsx(h,{})}),s.jsx(t.Item,{label:"Số điện thoại đăng nhập",name:"phone",children:s.jsx(h,{})}),s.jsx(t.Item,{label:"Email nhận thông tin",name:"email",children:s.jsx(h,{})}),s.jsx(t.Item,{children:s.jsx(N,{type:"warning",message:"Bạn sẽ cần đăng nhập lại sau khi cập nhật thông tin thành công"})}),s.jsx(t.Item,{children:s.jsx(k,{type:"primary",htmlType:"submit",loading:y,children:"Cập nhật"})})]})})})]})};export{R as default};
